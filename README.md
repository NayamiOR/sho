# 昭语言

昭语言（Sho） 是一个用于脚本化史书的开源工具链，致力于将传统史书（如《三国志》《资治通鉴》等）转化为结构化、可查询、可关联的数据，并支持多视角（编年体、纪传体、专题体、图谱）的历史观察方式。

## 核心特性

- 多类型历史元素建模
    - 支持事迹（deed）、言论（utterance）、状态（state）、关系（relation）、制度（institution）、事件（event）、评价（assessment）等七大类历史语义单元。
- 灵活的时间与空间表达
    - 内置模糊时间（如“章武初年”“建安十五年±1年”）、地理范围（如“阆中半径50公里”）以及历史政区变迁支持。
- 多源史料融合与冲突处理
  同一事件可来自多个出处，支持冲突标记，甚至类 Git 的分支式版本管理。
- 统一中间表示（IR）
    - 支持不同自然语言写脚本，经解析器使用统一 IR 输出
- 多视角查询引擎
- 模块化设计
    - 不同人整理的不同资料库可封装为独立模块，支持模块间引用和实体对齐

## 项目结构

- crates
    - sho_core - 核心库
    - sho_loader - 将解析得到的 IR 转为 Core 结构
    - sho_ir - 中间表示
    - sho_parser - 脚本解析器，输出 IR
    - sho_runtime - 运行时，负责运行和查询等
    - sho_storage - 实体（Entity）存储

## 工作流程

这个项目是一个DSL运行时，类似数据库软件但目前并没有或打算做数据持久化（冷存储）。或者可以说它是一个虚拟机。

录入时工作流程：

1. Parser 前端接收昭语言写的历史内容脚本
2. Parser 读取文件生成 AST 并转译成 IR（中间表示）
3. IR 被运行时读取并解析
4. 自动进行时间、地点信息的推理以及事件等信息索引
5. 录入完成，等待查询或数据导出

## 脚本样例

这里提供一个样例，语法目前采用类似 Lisp 的风格，但目前还未确定，仅用于帮助理解：

原文：

先主姓刘，讳备，字玄德，涿郡涿县人，汉景帝子中山靖王胜之后也。胜子贞，元狩六年封涿县陆城亭侯。坐酎金失侯，因家焉。

尝试脚本化的例子：

```lisp
(人物 刘备
	(姓 刘)
	(名 备)
	(字 玄德)
	(家乡 涿郡涿县))
	
(人物 刘胜
	(号 中山靖王)
	(姓 刘)
	(名 胜))
(关系定义
	(人物 刘备)
	(人物 中山靖王)
	(关系 后代))

(关系定义
	(人物 刘贞)
	(人物 刘胜)
	(关系 儿子))
(事件 <这里可以补充可选的label> 
	(人物 刘贞)
	(事件 封涿县陆城亭侯))
(事件 祭金事件
	(人物 刘贞)
	(事件 因在宗庙祭祀时所献祭金违犯礼制，而触犯律令被削去爵位)
	(事件 刘贞在涿县安家))
```

## 社区与讨论

- 主讨论区：[GitHub Discussions](https://github.com/NayamiOR/sho/discussions)
- QQ：[昭语言孵化器](https://qm.qq.com/q/oaWhupQXWo)（备注：sho）

## 我们需要你

昭语言尚在早期开发阶段，但核心理念已初步成型。我们诚邀以下伙伴加入讨论或贡献：

* 历史爱好者：帮助设计更合理的历史建模范式
* 语言设计者：参与 DSL 语法、中文方言解析器的打磨
* Rust 开发者：共建索引、查询引擎与 IR 系统
* 可视化工程师：将图谱输出对接前端
